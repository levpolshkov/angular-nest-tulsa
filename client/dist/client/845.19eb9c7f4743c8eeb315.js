(self.webpackChunktulsa_remote_application_client=self.webpackChunktulsa_remote_application_client||[]).push([[845],{8845:(e,n,t)=>{"use strict";t.r(n),t.d(n,{UserModule:()=>y});var r=t(8583),o=t(665),s=t(4330),i=t(2957),a=t(7770),l=t(4762),u=t(7716),c=t(274),d=t(915),g=t(4382);function h(e,n){if(1&e&&(u.TgZ(0,"option",17),u._uU(1),u.qZA()),2&e){const e=n.$implicit;u.Q6J("value",e.id),u.xp6(1),u.Oqu(e.name)}}function m(e,n){if(1&e){const e=u.EpF();u.TgZ(0,"form"),u.TgZ(1,"div",1),u.TgZ(2,"div",2),u.TgZ(3,"h2",3),u._uU(4,"User Detail"),u.qZA(),u.TgZ(5,"div",4),u.TgZ(6,"div",5),u.TgZ(7,"label"),u._uU(8,"First Name"),u.qZA(),u.TgZ(9,"input",6),u.NdJ("ngModelChange",function(n){return u.CHM(e),u.oxw().user.firstName=n}),u.qZA(),u.qZA(),u.TgZ(10,"div",5),u.TgZ(11,"label"),u._uU(12,"Last Name"),u.qZA(),u.TgZ(13,"input",7),u.NdJ("ngModelChange",function(n){return u.CHM(e),u.oxw().user.lastName=n}),u.qZA(),u.qZA(),u.qZA(),u.TgZ(14,"div",4),u.TgZ(15,"div",5),u.TgZ(16,"label"),u._uU(17,"Email Address"),u.qZA(),u.TgZ(18,"input",8),u.NdJ("ngModelChange",function(n){return u.CHM(e),u.oxw().user.email=n}),u.qZA(),u.qZA(),u.TgZ(19,"div",5),u.TgZ(20,"label"),u._uU(21,"Phone Number"),u.qZA(),u.TgZ(22,"input",9),u.NdJ("ngModelChange",function(n){return u.CHM(e),u.oxw().user.phone=n}),u.qZA(),u.qZA(),u.qZA(),u.TgZ(23,"div",4),u.TgZ(24,"div",5),u.TgZ(25,"label"),u._uU(26,"Password"),u.qZA(),u.TgZ(27,"input",10),u.NdJ("ngModelChange",function(n){return u.CHM(e),u.oxw().user.password=n}),u.qZA(),u.qZA(),u.TgZ(28,"div",5),u.TgZ(29,"label"),u._uU(30,"Type"),u.qZA(),u.TgZ(31,"select",11),u.NdJ("ngModelChange",function(n){return u.CHM(e),u.oxw().user.type=n}),u.YNc(32,h,2,2,"option",12),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(33,"div",13),u.TgZ(34,"button",14),u.NdJ("click",function(){return u.CHM(e),u.oxw().onSaveBtn()}),u._uU(35,"Save"),u.qZA(),u.TgZ(36,"button",15),u.NdJ("click",function(){return u.CHM(e),u.oxw().onResetPasswordBtn()}),u._uU(37,"Send Reset Password Email"),u.qZA(),u.TgZ(38,"button",16),u.NdJ("click",function(){return u.CHM(e),u.oxw().onDeleteBtn()}),u._uU(39,"Delete"),u.qZA(),u.qZA(),u.qZA(),u.qZA()}if(2&e){const e=u.oxw();u.xp6(9),u.Q6J("ngModel",e.user.firstName),u.xp6(4),u.Q6J("ngModel",e.user.lastName),u.xp6(5),u.Q6J("ngModel",e.user.email),u.xp6(4),u.Q6J("ngModel",e.user.phone),u.xp6(5),u.Q6J("ngModel",e.user.password),u.xp6(4),u.Q6J("ngModel",e.user.type),u.xp6(1),u.Q6J("ngForOf",e.userService.userTypes)}}let f=(()=>{class e{constructor(e,n,t,r,o){this.route=e,this.router=n,this.userService=t,this.alertService=r,this.confirmService=o}ngOnInit(){return(0,l.mG)(this,void 0,void 0,function*(){const e=this.route.snapshot.params.userId;console.log("UserDetailComponent: userId=%o",e),this.user="new"===e?{active:!0,type:"user"}:yield this.userService.getUserById(e),console.log("UserDetailComponent: user=%o",this.user)})}onSaveBtn(){return(0,l.mG)(this,void 0,void 0,function*(){yield this.userService.saveUser(this.user),this.alertService.info("Successfully saved user"),this.router.navigate(["/users"])})}onDeleteBtn(){return(0,l.mG)(this,void 0,void 0,function*(){this.confirmService.confirm({text:"Are you sure you want to delete this user?"}).then(e=>(0,l.mG)(this,void 0,void 0,function*(){console.log("onDelete: answer=%o",e),e&&(yield this.userService.deleteUserById(this.user._id),this.alertService.info("User deleted."),this.router.navigate(["/users"]))}))})}onResetPasswordBtn(){return(0,l.mG)(this,void 0,void 0,function*(){this.confirmService.confirm({text:"This will email the user a link to reset their password.  Continue?"}).then(e=>(0,l.mG)(this,void 0,void 0,function*(){e&&(yield this.userService.resetPassword({username:this.user.email,reason:"reset"}),this.alertService.info("User password email sent."),this.router.navigate(["/users"]))}))})}}return e.\u0275fac=function(n){return new(n||e)(u.Y36(s.gz),u.Y36(s.F0),u.Y36(c.K),u.Y36(d.c),u.Y36(g.z))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-user-detail-page"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"card","bg-light","mt-3","mb-3"],[1,"card-body"],[1,"card-title"],[1,"row","my-3"],[1,"col-sm-12","col-md-6"],["name","firstName",1,"form-control",3,"ngModel","ngModelChange"],["name","lastName",1,"form-control",3,"ngModel","ngModelChange"],["name","email","autocomplete","email",1,"form-control",3,"ngModel","ngModelChange"],["name","phone","mask","(000) 000-0000",1,"form-control",3,"ngModel","ngModelChange"],["type","password","name","password","autocomplete","new-password",1,"form-control",3,"ngModel","ngModelChange"],["name","type",1,"form-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"card-footer","d-flex","justify-content-between"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"btn","btn-danger",3,"click"],[3,"value"]],template:function(e,n){1&e&&u.YNc(0,m,40,7,"form",0),2&e&&u.Q6J("ngIf",n.user)},directives:[r.O5,o._Y,o.JL,o.F,o.Fj,o.JJ,o.On,o.EJ,r.sg,o.YN,o.Kr],styles:[""]}),e})();function p(e,n){if(1&e){const e=u.EpF();u.TgZ(0,"button",8),u.NdJ("click",function(){return u.CHM(e),u.oxw().onForgotPasswordBtn()}),u._uU(1),u.qZA()}if(2&e){const e=u.oxw();u.Q6J("disabled",e.forgotPasswordBusy||e.forgotPasswordDone),u.xp6(1),u.hij(" ",e.forgotPasswordBusy?"Resetting...":"Reset Password"," ")}}let Z=(()=>{class e{constructor(e,n,t,r){this.userService=e,this.alertService=n,this.router=t,this.route=r,this.creds={username:"",password:""},this.ForgotPasswordEnabled=!1,this.forgotPasswordBusy=!1,this.forgotPasswordDone=!1}ngOnInit(){console.log("UserLoginPageComponent.ngOnInit()"),this.route.snapshot.queryParams.resetCode&&this.loginWithResetCode(this.route.snapshot.queryParams.resetCode)}loginWithResetCode(e){return(0,l.mG)(this,void 0,void 0,function*(){console.log("UserResetComponent: resetCode=%o",e);const n=yield this.userService.getUserJwtByResetCode(e);console.log("UserResetComponent: userJwt=%o",n),(yield this.userService.loginWithUserJwt(n))&&this.router.navigate(["/user/profile"],{queryParams:{changePassword:!0}})})}onLoginBtn(){return(0,l.mG)(this,void 0,void 0,function*(){this.userService.login(this.creds).then(e=>{console.log("login: user=%o",e),this.alertService.info(`Successfully logged in as <b>${e.fullName}</b>`),this.router.navigate(["/dashboard"])},e=>{console.log("login err=%o",e),this.alertService.error(e.message||"There was a login error"),this.ForgotPasswordEnabled=!0})})}onForgotPasswordBtn(){this.forgotPasswordBusy=!0,this.userService.resetPassword({username:this.creds.username,reason:"forgot"}).then(e=>{this.alertService.info("Reset email was sent.  Please check your inbox."),console.log("UserLoginComponent.forgotPassword: result=%o",e),this.forgotPasswordDone=!0,this.forgotPasswordBusy=!1}).catch(e=>{this.alertService.error(e.message||"There was an error."),this.forgotPasswordBusy=!1})}}return e.\u0275fac=function(n){return new(n||e)(u.Y36(c.K),u.Y36(d.c),u.Y36(s.F0),u.Y36(s.gz))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-user-login-page"]],decls:18,vars:3,consts:[["form","ngForm"],[1,"row","mt-5"],[1,"col-4","offset-4"],["name","username","autocomplete","email",1,"form-control",3,"ngModel","ngModelChange"],["type","password","name","password","autocomplete","current-password",1,"form-control",3,"ngModel","ngModelChange"],[1,"mt-5"],["tabindex","1",1,"btn","btn-primary","float-end",3,"click"],["class","btn btn-warning float-start","tabindex","2",3,"disabled","click",4,"ngIf"],["tabindex","2",1,"btn","btn-warning","float-start",3,"disabled","click"]],template:function(e,n){1&e&&(u.TgZ(0,"form",null,0),u.TgZ(2,"h1"),u._uU(3,"Login"),u.qZA(),u.TgZ(4,"div",1),u.TgZ(5,"div",2),u.TgZ(6,"div"),u.TgZ(7,"label"),u._uU(8,"Email"),u.qZA(),u.TgZ(9,"input",3),u.NdJ("ngModelChange",function(e){return n.creds.username=e}),u.qZA(),u.qZA(),u.TgZ(10,"div"),u.TgZ(11,"label"),u._uU(12,"Password"),u.qZA(),u.TgZ(13,"input",4),u.NdJ("ngModelChange",function(e){return n.creds.password=e}),u.qZA(),u.qZA(),u.TgZ(14,"div",5),u.TgZ(15,"button",6),u.NdJ("click",function(){return n.onLoginBtn()}),u._uU(16,"Login"),u.qZA(),u.YNc(17,p,2,2,"button",7),u.qZA(),u.qZA(),u.qZA(),u.qZA()),2&e&&(u.xp6(9),u.Q6J("ngModel",n.creds.username),u.xp6(4),u.Q6J("ngModel",n.creds.password),u.xp6(4),u.Q6J("ngIf",n.ForgotPasswordEnabled))},directives:[o._Y,o.JL,o.F,o.Fj,o.JJ,o.On,r.O5],styles:[""]}),e})();var v=t(3252),T=t(1839);const M=["searchTable"];function A(e,n){if(1&e&&(u.TgZ(0,"option",10),u._uU(1),u.qZA()),2&e){const e=n.$implicit;u.Q6J("value",e.id),u.xp6(1),u.Oqu(e.name)}}let w=(()=>{class e{constructor(e,n){this.userService=e,this.router=n,this.userTypes=this.userService.userTypes}ngOnInit(){this.searchTable.searchUrl="/user",this.searchTable.params.size=10,this.searchTable.columns=[{field:"type",header:"Type",renderer:e=>this.userService.userTypeRenderer(e.type)},{field:"fullName",header:"Full Name"},{field:"email",header:"Email",hide:"sm"},{field:"phone",header:"Phone",hide:"sm"},{field:"active",header:"Active",renderer:e=>e.active?"Active":""}],this.searchTable.onRowClick=this.onUserClick,this.searchTable.params.filter={type:null},this.searchTable.addNewUrl="/user/new"}onUserClick(e){this.router.navigate(["/user",e._id])}addNewUser(){this.router.navigate(["user/new"])}}return e.\u0275fac=function(n){return new(n||e)(u.Y36(c.K),u.Y36(s.F0))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-user-search-page"]],viewQuery:function(e,n){if(1&e&&u.Gf(M,7),2&e){let e;u.iGM(e=u.CRH())&&(n.searchTable=e.first)}},decls:28,vars:7,consts:[[1,"card","bg-light","mt-3","mb-3"],[1,"card-body"],[1,"card-title","mb-3"],[1,"row","my-4"],[1,"col-sm-12","col-md-3"],[1,"form-label"],["name","fullName",1,"form-control",3,"ngModel","ngModelChange"],["name","email",1,"form-control",3,"ngModel","ngModelChange"],["name","phone",1,"form-control",3,"ngModel","ngModelChange"],["name","type",1,"form-select",3,"ngModel","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["searchTable",""],[3,"searchTable"]],template:function(e,n){if(1&e){const e=u.EpF();u.TgZ(0,"form"),u.TgZ(1,"div",0),u.TgZ(2,"div",1),u.TgZ(3,"h2",2),u._uU(4,"User Search"),u.qZA(),u.TgZ(5,"div",3),u.TgZ(6,"div",4),u.TgZ(7,"label",5),u._uU(8,"Name"),u.qZA(),u.TgZ(9,"input",6),u.NdJ("ngModelChange",function(n){return u.CHM(e),u.MAs(26).params.filter.fullName=n})("ngModelChange",function(){return u.CHM(e),u.MAs(26).onFilterChange()}),u.qZA(),u.qZA(),u.TgZ(10,"div",4),u.TgZ(11,"label",5),u._uU(12,"Email"),u.qZA(),u.TgZ(13,"input",7),u.NdJ("ngModelChange",function(n){return u.CHM(e),u.MAs(26).params.filter.email=n})("ngModelChange",function(){return u.CHM(e),u.MAs(26).onFilterChange()}),u.qZA(),u.qZA(),u.TgZ(14,"div",4),u.TgZ(15,"label",5),u._uU(16,"Phone"),u.qZA(),u.TgZ(17,"input",8),u.NdJ("ngModelChange",function(n){return u.CHM(e),u.MAs(26).params.filter.phone=n})("ngModelChange",function(){return u.CHM(e),u.MAs(26).onFilterChange()}),u.qZA(),u.qZA(),u.TgZ(18,"div",4),u.TgZ(19,"label",5),u._uU(20,"Type"),u.qZA(),u.TgZ(21,"select",9),u.NdJ("ngModelChange",function(n){return u.CHM(e),u.MAs(26).params.filter.type=n})("ngModelChange",function(){return u.CHM(e),u.MAs(26).onFilterChange(!0)}),u.TgZ(22,"option",10),u._uU(23,"ALL"),u.qZA(),u.YNc(24,A,2,2,"option",11),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u._UZ(25,"search-table",null,12),u._UZ(27,"search-footer",13)}if(2&e){const e=u.MAs(26);u.xp6(9),u.Q6J("ngModel",e.params.filter.fullName),u.xp6(4),u.Q6J("ngModel",e.params.filter.email),u.xp6(4),u.Q6J("ngModel",e.params.filter.phone),u.xp6(4),u.Q6J("ngModel",e.params.filter.type),u.xp6(1),u.Q6J("value",null),u.xp6(2),u.Q6J("ngForOf",n.userTypes),u.xp6(3),u.Q6J("searchTable",e)}},directives:[o._Y,o.JL,o.F,o.Fj,o.JJ,o.On,o.EJ,o.YN,o.Kr,r.sg,v.D,T.s],styles:[""]}),e})();function C(e,n){if(1&e){const e=u.EpF();u.TgZ(0,"form"),u.TgZ(1,"div",1),u.TgZ(2,"div",2),u.TgZ(3,"h2",3),u._uU(4,"User Profile"),u.qZA(),u.TgZ(5,"div",4),u.TgZ(6,"div",5),u.TgZ(7,"label"),u._uU(8,"First Name"),u.qZA(),u.TgZ(9,"input",6),u.NdJ("ngModelChange",function(n){return u.CHM(e),u.oxw().user.firstName=n}),u.qZA(),u.qZA(),u.TgZ(10,"div",5),u.TgZ(11,"label"),u._uU(12,"Last Name"),u.qZA(),u.TgZ(13,"input",7),u.NdJ("ngModelChange",function(n){return u.CHM(e),u.oxw().user.lastName=n}),u.qZA(),u.qZA(),u.qZA(),u.TgZ(14,"div",4),u.TgZ(15,"div",5),u.TgZ(16,"label"),u._uU(17,"Email Address"),u.qZA(),u.TgZ(18,"input",8),u.NdJ("ngModelChange",function(n){return u.CHM(e),u.oxw().user.email=n}),u.qZA(),u.qZA(),u.TgZ(19,"div",5),u.TgZ(20,"label"),u._uU(21,"Phone Number"),u.qZA(),u.TgZ(22,"input",9),u.NdJ("ngModelChange",function(n){return u.CHM(e),u.oxw().user.phone=n}),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(23,"div",10),u.TgZ(24,"button",11),u.NdJ("click",function(){return u.CHM(e),u.oxw().onSaveBtn()}),u._uU(25,"Save"),u.qZA(),u.TgZ(26,"button",12),u.NdJ("click",function(){return u.CHM(e),u.oxw().onChangePasswordBtn()}),u._uU(27,"Change Password"),u.qZA(),u.qZA(),u.qZA(),u.qZA()}if(2&e){const e=u.oxw();u.xp6(9),u.Q6J("ngModel",e.user.firstName),u.xp6(4),u.Q6J("ngModel",e.user.lastName),u.xp6(5),u.Q6J("ngModel",e.user.email),u.xp6(4),u.Q6J("ngModel",e.user.phone)}}const q=[{path:"",redirectTo:"search"},{path:"login",component:Z},{path:"profile",canActivate:[i.d],component:(()=>{class e{constructor(e,n,t,r){this.router=e,this.route=n,this.userService=t,this.alertService=r}ngOnInit(){return(0,l.mG)(this,void 0,void 0,function*(){this.user=yield this.userService.getCurrentUser(),console.log("UserProfilePageComponent: user=%o",this.user),this.route.snapshot.queryParams.changePassword&&this.onChangePasswordBtn()})}onSaveBtn(){return(0,l.mG)(this,void 0,void 0,function*(){yield this.userService.saveUser(this.user),this.alertService.info("Successfully saved user profile"),this.router.navigate(["/"])})}onChangePasswordBtn(){return(0,l.mG)(this,void 0,void 0,function*(){this.userService.openPasswordModal(this.user)})}}return e.\u0275fac=function(n){return new(n||e)(u.Y36(s.F0),u.Y36(s.gz),u.Y36(c.K),u.Y36(d.c))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-user-profile-page"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"card","bg-light","mt-3","mb-3"],[1,"card-body"],[1,"card-title"],[1,"row","my-3"],[1,"col-sm-12","col-md-6"],["name","firstName",1,"form-control",3,"ngModel","ngModelChange"],["name","lastName",1,"form-control",3,"ngModel","ngModelChange"],["name","email","autocomplete","email","disabled","",1,"form-control",3,"ngModel","ngModelChange"],["name","phone","mask","(000) 000-0000",1,"form-control",3,"ngModel","ngModelChange"],[1,"card-footer","d-flex","justify-content-between"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-warning",3,"click"]],template:function(e,n){1&e&&u.YNc(0,C,28,4,"form",0),2&e&&u.Q6J("ngIf",n.user)},directives:[r.O5,o._Y,o.JL,o.F,o.Fj,o.JJ,o.On],styles:[""]}),e})()},{path:"search",canActivate:[i.d],component:w},{path:":userId",canActivate:[i.d],component:f}];let b=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[s.Bz.forChild(q),a.t],s.Bz]}),e})(),y=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[r.ez,o.u5,b,a.t]]}),e})()}}]);